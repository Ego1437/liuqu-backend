databaseChangeLog:
  - changeSet:
      id: 1-create-user-table
      author: Ego
      changes:
#       User table
        - createTable:
            tableName: users
            columns:
                - column:
                    name: user_id
                    type: bigint
                    autoIncrement: true
                    constraints:
                      primaryKey: true
                      nullable: false
                - column:
                    name: user_name
                    type: varchar(50)
                    constraints:
                      remarks: "用户姓名"
                      nullable: false
                - column:
                    name: user_tel
                    type: varchar(20)
                    constraints:
                      remarks: "用户电话"
                      nullable: false
                - column:
                    name: user_email
                    type: varchar(30)
                    constraints:
                      remarks: "用户邮箱"
                      nullable: false
                - column:
                    name: avatar
                    type: varchar(30)
                    constraints:
                      remarks: "用户头像"
                      nullable: false
                - column:
                    name: password
                    type: varchar(20)
                - column:
                    name: age
                    type: int
                - column:
                    name: gender
                    type: varchar(10)
                - column:
                    name: address
                    type: varchar(100)
                - column:
                    name: postcode
                    type: int
                - column:
                    name: is_subscribe
                    type: int

  - changeSet:
      id: 2-create-activities-table
      author: Ego
      changes:
        - createTable:
            tableName: activities
            columns:
              - column:
                  name: activity_id
                  type: bigint
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: activity_name
                  type: varchar(255)
                  constraints:
                    remarks: "活动类型"
                    primaryKey: true
                    nullable: false
              - column:
                  name: partner_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: customer_staff_id
                  type: int
                  constraints:
                    nullable: false
              - column:
                  name: activity_address
                  type: varchar(255)
                  constraints:
                    remarks: "活动地址"
                    nullable: false
              - column:
                  name: category_level_1
                  type: int
                  constraints:
                    remarks: "活动一级分类"
                    nullable: false
              - column:
                  name: category_level_2
                  type: int
                  constraints:
                    remarks: "活动二级分类"
                    nullable: false
              - column:
                  name: activity_image
                  type: text  # Adjust this type based on your specific DB support for JSON
                  constraints:
                    nullable: false
              - column:
                  name: activity_duration
                  type: bigint
                  constraints:
                    remarks: "活动时长"
                    nullable: false
              - column:
                  name: portfolio
                  type: text  # Adjust this type based on your specific DB support for JSON
              - column:
                  name: activity_detail
                  type: text  # Adjust this type based on your specific DB support for JSON
              - column:
                  name: activity_status
                  type: int
                  constraints:
                    remarks: "活动状态"
                    nullable: false


  - changeSet:
      id: 3-create-events-table
      author: Ego
      changes:
        - createTable:
            tableName: events
            columns:
              - column:
                  name: event_id
                  type: bigint
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: activity_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: start_time
                  type: datetime
                  constraints:
                    remarks: "开始时间"
                    nullable: false
              - column:
                  name: deadline
                  type: datetime
                  constraints:
                    remarks: "结束时间"
                    nullable: false
              - column:
                  name: max_capacity
                  type: int
                  constraints:
                    remarks: "活动最高人数"
                    nullable: false
              - column:
                  name: residual_num
                  type: int
                  constraints:
                    remarks: "上车人数"
                    nullable: false
              - column:
                  name: event_status
                  type: int
                  constraints:
                    nullable: false

  - changeSet:
      id: 4-create-tickets-table
      author: Ego
      changes:
        - createTable:
            tableName: tickets
            columns:
              - column:
                  name: ticket_id
                  type: bigint
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: event_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: name
                  type: varchar(255)
                  constraints:
                    nullable: false
              - column:
                  name: price
                  type: decimal(10,2)
                  constraints:
                    nullable: false
              - column:
                  name: deadline
                  type: datetime
                  constraints:
                    nullable: false



  - changeSet:
      id: 5-create-order-table
      author: Ego
      changes:
        - createTable:
            tableName: orders
            columns:
              - column:
                  name: order_id
                  type: bigint
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: activity_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: event_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: ticket_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: customer_staff_id
                  type: int
                  constraints:
                    nullable: false
              - column:
                  name: user_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: total_amount
                  type: decimal(10,2)
                  constraints:
                    nullable: false
              - column:
                  name: price
                  type: decimal(10,2)
              - column:
                  name: quantity
                  type: int
                  constraints:
                    nullable: false
              - column:
                  name: platform_discount
                  type: decimal(10,2)
              - column:
                  name: final_amount
                  type: decimal(10,2)
                  constraints:
                    nullable: false
              - column:
                  name: order_date
                  type: date
                  constraints:
                    nullable: false
  - changeSet:
      id: 6-create-notification-table
      author: Ego
      changes:
        - createTable:
            tableName: notifications
            columns:
              - column:
                  name: notification_id
                  type: bigint
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: user_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: activity_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: event_time
                  type: date
                  constraints:
                    nullable: false
              - column:
                  name: promotion
                  type: varchar(100)

  - changeSet:
      id: 7-create-partners-table
      author: Ego
      changes:
        - createTable:
            tableName: partners
            columns:
              - column:
                  name: partner_id
                  type: bigint
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: partner_staff_id
                  type: int
                  constraints:
                    nullable: false
              - column:
                  name: b_name
                  type: char(50)
                  constraints:
                    nullable: false
              - column:
                  name: b_tel
                  type: varchar(20)
                  constraints:
                    nullable: false
              - column:
                  name: b_email
                  type: varchar(30)
                  constraints:
                    nullable: false
              - column:
                  name: password
                  type: varchar(20)
              - column:
                  name: create_time
                  type: date
              - column:
                  name: type
                  type: varchar(10)

              - column:
                  name: address
                  type: varchar(100)
              - column:
                  name: postcode
                  type: int
              - column:
                  name: description
                  type: varchar(200)
              - column:
                  name: ticket_total
                  type: int
                  defaultValueNumeric: 0
                  constraints:
                    nullable: false
              - column:
                  name: fans_count
                  type: int
                  defaultValueNumeric: 0
                  constraints:
                    nullable: false

  - changeSet:
      id: 9-create-customer-staff-table
      author: Ego
      changes:
        - createTable:
            tableName: customer_staffs
            columns:
              - column:
                  name: customer_staff_id
                  type: int
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: staff_name
                  type: char(50)
                  constraints:
                    nullable: false
              - column:
                  name: staff_tel
                  type: varchar(20)
                  constraints:
                    nullable: false
              - column:
                  name: staff_email
                  type: varchar(30)
                  constraints:
                    nullable: false
              - column:
                  name: password
                  type: varchar(20)
              - column:
                  name: age
                  type: int
              - column:
                  name: gender
                  type: varchar(10)
              - column:
                  name: partner_id
                  type: bigint
                  constraints:
                    nullable: true
                    foreignKeyName: fk_customer_staffs_partners
                    references: partners(partner_id)


  - changeSet:
      id: 10-create-partners-table
      author: Ego
      changes:
        - createTable:
            tableName: partner_staffs
            columns:
              - column:
                  name: partner_staff_id
                  type: int
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: staff_name
                  type: char(50)
                  constraints:
                    nullable: false
              - column:
                  name: staff_type
                  type: int
                  constraints:
                    nullable: false
              - column:
                  name: staff_tel
                  type: varchar(20)
                  constraints:
                    nullable: false
              - column:
                  name: staff_email
                  type: varchar(30)
                  constraints:
                    nullable: false
              - column:
                  name: password
                  type: varchar(20)
              - column:
                  name: age
                  type: int
              - column:
                  name: gender
                  type: varchar(10)

  - changeSet:
      id: 11-create-tags-dictionary-table
      author: Ego
      changes:
        - createTable:
            tableName: tags
            columns:
              - column:
                  name: tag_id
                  type: int
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: tag_name
                  type: varchar(255)
                  constraints:
                    nullable: false
                    unique: true

  - changeSet:
      id: 12-create-activity-tags-table
      author: Ego
      changes:
        - createTable:
            tableName: activity_tags
            columns:
              - column:
                  name: activity_id
                  type: bigint
                  constraints:
                    nullable: false
                    foreignKeyName: fk_activity_tags_activities
                    references: activities(activity_id)
              - column:
                  name: tag_id
                  type: int
                  constraints:
                    nullable: false
                    foreignKeyName: fk_activity_tags_tags
                    references: tags(tag_id)
        - addPrimaryKey:
            tableName: activity_tags
            columnNames: activity_id, tag_id

  - changeSet:
      id: 1-add-fk-events-activity_id
      author: Ego
      changes:
        - addForeignKeyConstraint:
            baseTableName: events
            baseColumnNames: activity_id
            constraintName: fk_events_activity_id
            referencedTableName: activities
            referencedColumnNames: activity_id
            onDelete: CASCADE

  - changeSet:
      id: 2-add-fk-tickets-event_id
      author: Ego
      changes:
        - addForeignKeyConstraint:
            baseTableName: tickets
            baseColumnNames: event_id
            constraintName: fk_tickets_event_id
            referencedTableName: events
            referencedColumnNames: event_id
            onDelete: CASCADE

  - changeSet:
      id: 3-add-fk-activities-partner_id
      author: Ego
      changes:
        - addForeignKeyConstraint:
            baseTableName: activities
            baseColumnNames: partner_id
            constraintName: fk_activities_partner_id
            referencedTableName: partners
            referencedColumnNames: partner_id
            onDelete: CASCADE

  - changeSet:
      id: 4-add-fk-activities-staff_id
      author: Ego
      changes:
        - addForeignKeyConstraint:
            baseTableName: activities
            baseColumnNames: customer_staff_id
            constraintName: fk_activities_staff_id
            referencedTableName: customer_staffs
            referencedColumnNames: customer_staff_id
            onDelete: CASCADE

  - changeSet:
      id: 5-add-fk-order-activity_id
      author: Ego
      changes:
        - addForeignKeyConstraint:
            baseTableName: orders
            baseColumnNames: activity_id
            constraintName: fk_order_activity_id
            referencedTableName: activities
            referencedColumnNames: activity_id
            onDelete: CASCADE

  - changeSet:
      id: 6-add-fk-order-event_id
      author: Ego
      changes:
        - addForeignKeyConstraint:
            baseTableName: orders
            baseColumnNames: event_id
            constraintName: fk_order_event_id
            referencedTableName: events
            referencedColumnNames: event_id
            onDelete: CASCADE

  - changeSet:
      id: 7-add-fk-order-ticket_id
      author: Ego
      changes:
        - addForeignKeyConstraint:
            baseTableName: orders
            baseColumnNames: ticket_id
            constraintName: fk_order_ticket_id
            referencedTableName: tickets
            referencedColumnNames: ticket_id
            onDelete: CASCADE

  - changeSet:
      id: 8-add-fk-order-staff_id
      author: Ego
      changes:
        - addForeignKeyConstraint:
            baseTableName: orders
            baseColumnNames: customer_staff_id
            constraintName: fk_order_staff_id
            referencedTableName: customer_staffs
            referencedColumnNames: customer_staff_id
            onDelete: CASCADE

  - changeSet:
      id: 9-add-fk-order-user_id
      author: Ego
      changes:
        - addForeignKeyConstraint:
            baseTableName: orders
            baseColumnNames: user_id
            constraintName: fk_order_user_id
            referencedTableName: users
            referencedColumnNames: user_id
            onDelete: CASCADE

  - changeSet:
      id: 10-add-fk-notification-user_id
      author: Ego
      changes:
        - addForeignKeyConstraint:
            baseTableName: notifications
            baseColumnNames: user_id
            constraintName: fk_notification_user_id
            referencedTableName: users
            referencedColumnNames: user_id
            onDelete: CASCADE

  - changeSet:
      id: 11-add-fk-notification-activity_id
      author: Ego
      changes:
        - addForeignKeyConstraint:
            baseTableName: notifications
            baseColumnNames: activity_id
            constraintName: fk_notification_activity_id
            referencedTableName: activities
            referencedColumnNames: activity_id
            onDelete: CASCADE

  - changeSet:
      id: 12-add-fk-partner_staffs-partner
      author: Ego
      changes:
        - addForeignKeyConstraint:
            constraintName: fk_partner_staffs_partner
            baseTableName: partners
            baseColumnNames: partner_staff_id
            referencedTableName: partner_staffs
            referencedColumnNames: partner_staff_id

  - changeSet:
      id: 1-insert-default-tags
      author: Ego
      changes:
        - insert:
            tableName: tags
            columns:
              - column:
                  name: tag_name
                  value: "机制"
        - insert:
            tableName: tags
            columns:
              - column:
                  name: tag_name
                  value: "欢乐"
        - insert:
            tableName: tags
            columns:
              - column:
                  name: tag_name
                  value: "烧脑"
        - insert:
            tableName: tags
            columns:
              - column:
                  name: tag_name
                  value: "恐怖"
        - insert:
            tableName: tags
            columns:
              - column:
                  name: tag_name
                  value: "沉浸"

  - changeSet:
      id: 2-insert-default-partner-staff
      author: your_name
      changes:
        - insert:
            tableName: partner_staffs
            columns:
              - column:
                  name: staff_name
                  value: "Default Partner Staff"
              - column:
                  name: staff_type
                  value: "1"
              - column:
                  name: staff_tel
                  value: "1234567890"
              - column:
                  name: staff_email
                  value: "partnerstaff@example.com"
              - column:
                  name: password
                  value: "securepassword"
              - column:
                  name: age
                  value: "30"
              - column:
                  name: gender
                  value: "Non-Binary"

  - changeSet:
      id: 3-insert-default-partner
      author: Ego
      changes:
        - insert:
            tableName: partners
            columns:
              - column:
                  name: b_name
                  value: "Default Partner Business"
              - column:
                  name: b_tel
                  value: "0987654321"
              - column:
                  name: b_email
                  value: "partner@example.com"
              - column:
                  name: password
                  value: "securepassword"
              - column:
                  name: type
                  value: "1"
              - column:
                  name: address
                  value: "123 Main St"
              - column:
                  name: postcode
                  value: "12345"
              - column:
                  name: description
                  value: "A default partner description."
              - column:
                  name: partner_staff_id
                  value: "1"

  - changeSet:
      id: 4-insert-default-customer-staff
      author: Ego
      changes:
        - insert:
            tableName: customer_staffs
            columns:
              - column:
                  name: staff_name
                  value: "Default Customer Staff"
              - column:
                  name: staff_tel
                  value: "1234567890"
              - column:
                  name: staff_email
                  value: "customerstaff@example.com"
              - column:
                  name: password
                  value: "securepassword"
              - column:
                  name: age
                  value: "25"
              - column:
                  name: gender
                  value: "1"
              - column:
                  name: partner_id
                  valueNumeric: 1
  - changeSet:
      id: 1-create-index-on-activities-partner_id
      author: Ego
      changes:
        - createIndex:
            tableName: activities
            columns:
              - column:
                  name: partner_id
            indexName: idx_activities_partner_id

